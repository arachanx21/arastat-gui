<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Device Configuration - Arastat GUI</title>
    <link rel="stylesheet" href="style.css">
    <script src="jquery.js"></script>
</head>
<body>
    <div class="shell">
        <header>
            <a href="/" class="brand" aria-label="Home">
                <div class="logo">A</div>
                <div>
                    <div style="font-weight:700">Arastat GUI</div>
                    <div style="font-size:12px;color:var(--muted)">Admin single page</div>
                </div>
            </a>

            <nav aria-label="Main navigation">
                <div class="nav-links">
                    <a class="btn" href="/">Mission Control</a>
                    <!-- <a class="btn" href="#reports">Reports</a> -->
                    <a class="btn" href="/setting">Settings</a>
                </div>
            </nav>
        </header>

        <main style="grid-column:1 / -1; max-width:800px; margin:0 auto;">
            <section class="hero" aria-labelledby="conf-title">
                <div>
                    <h1 id="conf-title">Configure Device</h1>
                    <p style="color:var(--muted)">Set experiment parameters and device settings.</p>
                </div>
            </section>

            <section style="margin-top:16px;">
                <div class="panel">
                    <h4>Experiment Parameters</h4>
                    <form id="configForm">
                        <div class="grid">
                            <div class="card">
                                <h4>Mode</h4>
                                <select id="mode" required>
                                    <option value="1">Linear Sweep Voltammetry</option>
                                    <option value="2">Cyclic Voltammetry</option>
                                    <option value="3">Chronoamperometry</option>
                                </select>
                            </div>

                            <div class="card">
                                <h4>Starting Voltage (mV)</h4>
                                <input id="startingVoltage" required value="-600" min="-1650" max="1650" type="number">
                            </div>

                            <div class="card">
                                <h4>Final Voltage (mV)</h4>
                                <input id="finalVoltage" required value="600" min="-1650" max="1650" type="number">
                            </div>

                            <div class="card">
                                <h4>Scan Rate (mV/s)</h4>
                                <select id="scanRate">
                                    <option value="10">10</option>
                                    <option value="25">25</option>
                                    <option value="50">50</option>
                                    <option value="100">100</option>
                                    <option value="250">250</option>
                                    <option value="500">500</option>
                                </select>
                            </div>

                            <div class="card">
                                <h4>idle Voltage(mV)</h4>
                                <input id="idleVoltage" required value="-600" min="-1650" max="1650" type="number">
                            </div>

                            <div class="card">
                                <h4>Quiet Time (ms)</h4>
                                <input id="quietTime" required value="1000" min="0" max="20000" type="number">
                            </div>

                            <!-- <div class="card">
                                <h4>Reference Voltage (mV)</h4>
                                <input id="refVoltage" value="1650" type="number">
                            </div>

                            <div class="card">
                                <h4>RTIA (Ω)</h4>
                                <input id="RTIA" value="1000" type="number">
                            </div> -->
                        </div>

                        <div style="margin-top:12px; display:flex; gap:8px;">
                            <button id="submitConfig" class="btn cta" type="submit">Apply</button>
                            <button id="resetConfig" class="btn" type="button">Reset</button>
                        </div>
                    </form>
                </div>
            </section>
        </main>

        <footer style="grid-column:1 / -1; margin-top:18px; color:var(--muted);">
            <div>© <strong>Arastat GUI</strong></div>
            <div style="color:var(--muted)">Configuration</div>
        </footer>
    </div>

    <script>
    // jQuery is loaded via jquery.js
    $(function(){
        function readForm(){
            return {
                mode: parseInt($('#mode').val()),
                startingVoltage: parseInt($('#startingVoltage').val()),
                finalVoltage: parseInt($('#finalVoltage').val()),
                scanRate: parseInt($('#scanRate').val()),
                samplingRate: parseInt($('#samplingRate').val()),
                quietTime: parseInt($('#quietTime').val()),
                refVoltage: parseInt($('#refVoltage').val()),
                RTIA: parseInt($('#RTIA').val())
            };
        }

        $('#configForm').on('submit', function(e){
            e.preventDefault();
            const data = readForm();
            $.ajax({
                url: '/set',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify(data),
                dataType: 'json',
                success: function(resp){ alert('Configuration sent'); },
                error: function(){ alert('Failed to send configuration'); }
            });
        });

        $('#resetConfig').on('click', function(){
            $('#configForm')[0].reset();
        });
    });
    </script>
</body>
</html>